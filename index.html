<!-- PHK ‚Äì Unified Final (inline SWAP icon) ‚Äì 2025-10-19 -->
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>PHK Basketball Schedule 2025/2026</title>

  <!-- PWA / Homescreen -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="theme-color" content="#ffffff" />

  <link href="https://fonts.googleapis.com/css2?family=Lunasima:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --phk-blue:#0066cc;
      --bg:#1a1a1a;
      --text:#fff;
      --shadow:0 4px 12px rgba(0,0,0,.25);
    }
    *{ box-sizing:border-box; }
    html, body{ margin:0; padding:0; }
    body{
      font-family:'Lunasima', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    /* Header */
    .header{
      text-align:center;
      padding:clamp(24px, 4vw, 48px) 16px;
      background:#fff;
      color:#000;
      position:relative;
    }
    .logo{ width:min(338px, 71.5vw); aspect-ratio:1/1; margin:0 auto 20px; }
    .logo img{ width:100%; height:100%; object-fit:contain; }
    .league-name{ font-weight:700; color:var(--phk-blue); font-size:clamp(18px, 4.5vw, 28px); margin-bottom:6px; }
    .season-title{ text-transform:uppercase; line-height:1.2; font-weight:600; color:#000; font-size:clamp(18px, 4vw, 26px); }

    /* Floating controls */
    .league-switcher{ position:fixed; left:calc(env(safe-area-inset-left) + 12px); right:auto; top:calc(env(safe-area-inset-top) + 12px); display:inline-flex; align-items:center; gap:8px; background:transparent; border:0; box-shadow:none; color:var(--phk-blue); font-weight:800; font-size: 19.2px; line-height:1; padding:4px 8px; cursor:pointer; z-index:9999; text-decoration:none; transition:transform .12s ease, opacity .12s ease; }
.league-switcher:hover{ transform:scale(1.06); opacity:.92; }
.league-switcher:active{ transform:scale(0.98); opacity:.88; }
.league-switcher:focus-visible{ outline:3px solid #b3d7ff; outline-offset:2px; }
    .league-switcher svg{ width: 19.2px; height: 19.2px; flex:0 0 auto; }
    .league-switcher:hover, .league-switcher:focus-visible{ transform:scale(1.05); outline:none; }
    /* ensure no legacy icon */
    .admin-toggle{
      position:fixed;
      right:calc(env(safe-area-inset-right) + 12px); left:auto;
      top:calc(env(safe-area-inset-top) + 12px);
      background:var(--phk-blue); color:#fff; border:none;
      padding:10px 16px; border-radius:12px; font-weight:700; z-index:9999;
      box-shadow:var(--shadow); font-size:14px;
    }
    .admin-toggle:focus-visible{ outline:3px solid #b3d7ff; outline-offset:2px; }

    .export-btn, .add-game-btn{
      position:fixed; right:calc(env(safe-area-inset-right) + 16px); bottom:calc(16px + env(safe-area-inset-bottom));
      border:none; border-radius:999px; padding:14px 18px; font-size:16px;
      box-shadow:var(--shadow); z-index:20; display:none;
    }
    .export-btn{ background:#0d6efd; color:#fff; right:calc(env(safe-area-inset-right) + 168px); }
    .export-btn:hover{ filter:brightness(.95); }
    .add-game-btn{ background:#28a745; color:#fff; }
    .add-game-btn:hover{ filter:brightness(.95); }

    /* Games list ‚Äì full bleed */
    .games-container{ width:100vw; max-width:100vw; margin:0; padding:0; }
    .game-strip{
      width:100vw;
      margin-left:calc(50% - 50vw);
      margin-right:calc(50% - 50vw);
      min-height:184px;
      display:flex; flex-direction:column; justify-content:center; align-items:center;
      padding:36px 16px; text-align:center; position:relative;
      border-bottom:2px solid #fff;
    }
    .game-strip.home{ background:#0066cc; }
    .game-strip.away{ background:#000; }
    .game-strip.played.home{ background:#045db7; }
    .game-strip.played.away{ background:#111; }

    .teams{ display:grid; grid-template-columns:1fr auto 1fr; align-items:baseline; gap:28px; width:100%; }
    .team{
      font-weight:700;
      font-size:80px;  /* Desktop fixed size */
      line-height:1.1;
      word-break:break-word;
      overflow-wrap:anywhere;
    }
    .team:first-child{ text-align:end; }
    .team:last-child{ text-align:start; }
    .team.hebrew{ direction:rtl; }
    .score{
      font-weight:800; letter-spacing:1px;
      font-size:80px;  /* Desktop fixed size */
      line-height:1.1; min-width:160px;
    }

    .game-date, .game-number, .venue{ font-size:clamp(12px, 3.5vw, 18px); margin-top:8px; }
    .venue a{ color:#fff; text-decoration:none; }

    .edit-btn, .delete-btn{
      position:absolute; top:10px;
      padding:8px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.6);
      background:rgba(255,255,255,.15); color:#fff; cursor:pointer; font-size:14px;
    }
    .edit-btn{ inset-inline-end:10px; }
    .delete-btn{ inset-inline-end:90px; background:rgba(220,53,69,.9); border-color:rgba(220,53,69,1); }
    .delete-btn:hover{ filter:brightness(.95); }

    /* Mobile: fixed 25px sizes and visible leagues button */
    @media (max-width:600px){
      .league-switcher{ font-size: 24px; padding:6px 10px;  .league-switcher svg{ width:24px; height:24px; 
      /* --- Mobile refinements --- */
      .teams{ gap:12px; }
      .team{ white-space:nowrap; min-width:9ch; }
      .score{ min-width:auto; }
      .game-strip{ padding:28px 8px; } /* 8px side gutters */
      /* Titles +10% */
      .league-name{ font-size:clamp(20px, 5vw, 31px); }
      .season-title{ font-size:clamp(20px, 4.6vw, 29px); }
      /* Game number +20% */
      .game-number{ font-size:120%; }
    
    } }}

      .league-switcher{ display:inline-flex; height:36px; padding:0 12px; font-size:14px; }
      .team, .score{ font-size:25px !important; }
      .teams{ gap:12px; }
      .game-strip{ padding:28px 12px; }
      .logo{ width:234px; }
    }
  </style>
</head>
<body>
  <button class="league-switcher" onclick="switchLeague()" title="◊ú◊ô◊í◊ï◊™">◊ú◊ô◊í◊ï◊™<svg viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"><path d="M10.9692 4.32324H5.43077C2.98372 4.32324 1 6.30697 1 8.75401V8.9694" stroke="#1A6DFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M8.56271 0.999785L11.6957 4.13281L8.56271 7.26584" stroke="#1A6DFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M4.15577 12.0771H9.69423C12.1413 12.0771 14.125 10.0934 14.125 7.64638V7.43099" stroke="#1A6DFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M6.56229 15.4006L3.42926 12.2676L6.56229 9.13455" stroke="#1A6DFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg></button>
  <button class="admin-toggle" onclick="toggleAdminMode()">Admin Mode: OFF</button>
  <button class="export-btn" id="exportBtn" onclick="exportData()">üì• Export JSON</button>
  <button class="add-game-btn" id="addGameBtn" onclick="addNewGame()">+ Add Game</button>

  <header class="header">
    <div class="logo"><img src="logo.png" alt="PHK Logo" /></div>
    <div class="league-name" id="leagueName">◊ô◊ú◊ì◊ô◊ù ◊ë◊≥ ◊©◊ï◊û◊®◊ï◊ü (◊û◊ê◊û◊ü ◊©◊ß◊ì)</div>
    <div class="season-title">GAME SEASON<br/>2025/2026</div>
  </header>

  <main class="games-container" id="gamesContainer" role="list"></main>

  <!-- Modal -->
  <div class="modal" id="editModal" role="dialog" aria-modal="true" aria-labelledby="editTitle" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:50;">
    <div class="modal-content" style="background:#fff; color:#000; width:min(680px, 92vw); max-height:90vh; overflow:auto; border-radius:16px; padding:24px; box-shadow:0 4px 12px rgba(0,0,0,.25); margin:auto;">
      <h2 id="editTitle">Edit Game</h2>
      <form id="editForm">
        <input type="hidden" id="editIndex" />
        <div class="form-group"><label>Game Number:</label><input type="number" id="editGameNumber" min="1" required /></div>
        <div class="form-group"><label>Game Type:</label>
          <select id="editType"><option value="home">Home</option><option value="away">Away</option></select>
        </div>
        <div class="form-group"><label>Home Team:</label><input type="text" id="editTeam1" required /></div>
        <div class="form-group"><label>Home Team Suffix (optional, e.g., S, W):</label><input type="text" id="editTeam1Suffix" maxlength="2" /></div>
        <div class="form-group"><label>Away Team:</label><input type="text" id="editTeam2" required /></div>
        <div class="form-group"><label>Away Team Suffix (optional, e.g., S, W):</label><input type="text" id="editTeam2Suffix" maxlength="2" /></div>
        <div class="form-group"><label>Score (format: 0:0):</label><input type="text" id="editScore" pattern="\d+:\d+" required /></div>
        <div class="form-group"><label>Date (e.g., Nov 13, 2025):</label><input type="text" id="editDate" required /></div>
        <div class="form-group"><label>Time (e.g., 17:30):</label><input type="text" id="editTime" required /></div>
        <div class="form-group"><label>Venue Name:</label><input type="text" id="editVenue" required /></div>
        <div class="form-group"><label>Venue Google Maps Link:</label><input type="url" id="editVenueLink" required /></div>

        <div class="form-actions" style="display:flex; gap:10px; margin-top:16px;">
          <button type="submit" class="btn btn-primary" style="padding:10px 16px; border:none; border-radius:10px; font-weight:700; background:var(--phk-blue); color:#fff;">Save</button>
          <button type="button" class="btn btn-secondary" style="padding:10px 16px; border:none; border-radius:10px; font-weight:700; background:#6c757d; color:#fff;" onclick="closeModal()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let adminMode = false;
    let currentLeague = '◊ë'; // '◊ë' or '◊ê'

    const leagueData = {
      '◊ë': { name: '◊ô◊ú◊ì◊ô◊ù ◊ë◊≥ ◊©◊ï◊û◊®◊ï◊ü (◊û◊ê◊û◊ü ◊©◊ß◊ì)', games: [] },
      '◊ê': { name: '◊ß◊ò ◊°◊ú ◊ê◊≥ (◊û◊ê◊û◊ü: ◊ô◊ê◊ô◊®/◊ô◊ï◊™◊ù)', games: [] }
    };
    let games = [];

    // Load from JSON with graceful fallback
    async function loadGamesFromJSON(){
      try{
        // prefer previously saved local data if exists
        const saved = JSON.parse(localStorage.getItem('phkLeagueData') || 'null');
        if(saved){ leagueData['◊ë'].games = saved['◊ë'] || []; leagueData['◊ê'].games = saved['◊ê'] || []; }
      }catch(e){}

      try{
        const res = await fetch('games-data.json',{cache:'no-store'});
        if(res.ok){
          const json = await res.json();
          leagueData['◊ë'].games = json['◊ë'] || leagueData['◊ë'].games;
          leagueData['◊ê'].games = json['◊ê'] || leagueData['◊ê'].games;
        }
      }catch(e){ /* ignore network errors */ }

      if(!leagueData['◊ë'].games.length && !leagueData['◊ê'].games.length){
        leagueData['◊ë'].games = [{
          type:'home', team1:'PHK', team1Suffix:'S', team2:'PHK', team2Suffix:'', score:'0:0',
          date:'Nov 13, 2025', time:'17:30',
          venue:'◊ë◊ô◊î"◊° ◊û◊¢◊ô◊ô◊†◊ï◊™, ◊®◊ó\' ◊î◊¶◊ú◊ô◊ú 8, ◊§◊®◊ì◊° ◊ó◊†◊î ◊õ◊®◊õ◊ï◊®',
          venueLink:'https://maps.app.goo.gl/ehjmqR18a53PCmG7A'
        }];
        leagueData['◊ê'].games = leagueData['◊ë'].games.slice();
      }

      games = leagueData[currentLeague].games;
      document.getElementById('leagueName').textContent = leagueData[currentLeague].name;
      renderGames();
    }

    function saveGames(){
      const dataToSave = { '◊ë': leagueData['◊ë'].games, '◊ê': leagueData['◊ê'].games };
      localStorage.setItem('phkLeagueData', JSON.stringify(dataToSave));
      localStorage.setItem('phkCurrentLeague', currentLeague);
    }

    function exportData(){
      const dataToExport = { '◊ë': leagueData['◊ë'].games, '◊ê': leagueData['◊ê'].games };
      const jsonString = JSON.stringify(dataToExport, null, 2);
      const blob = new Blob([jsonString], { type:'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'games-data.json';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      alert('JSON file downloaded! Upload this file to Netlify/GitHub Pages to update your site.');
    }

    function switchLeague(){
      leagueData[currentLeague].games = games;
      currentLeague = currentLeague === '◊ë' ? '◊ê' : '◊ë';
      games = leagueData[currentLeague].games;
      document.getElementById('leagueName').textContent = leagueData[currentLeague].name;
      saveGames();
      renderGames();
    }

    function renderGames(){
      const container = document.getElementById('gamesContainer');
      container.innerHTML = '';
      games.forEach((game, index) => {
        const el = document.createElement('div');
        const isPlayed = game.score && game.score !== '0:0';
        const playedClass = isPlayed ? 'played' : '';
        el.className = `game-strip ${game.type} ${playedClass}`;

        const isTeam1Heb = !String(game.team1).startsWith('PHK');
        const isTeam2Heb = !String(game.team2).startsWith('PHK');
        const t1Class = isTeam1Heb ? 'team hebrew' : 'team';
        const t2Class = isTeam2Heb ? 'team hebrew' : 'team';

        const gameNumber = String(index + 1).padStart(2, '0');

        el.innerHTML = `
          ${adminMode ? `<button class="delete-btn" onclick="deleteGame(${index})">Delete</button>` : ''}
          ${adminMode ? `<button class="edit-btn" onclick="editGame(${index})">Edit</button>` : ''}
          <div class="teams">
            <span class="${t1Class}">${game.team1}${game.team1Suffix ? `<span class="team-suffix">${game.team1Suffix}</span>` : ''}</span>
            <span class="score" aria-label="Score">${game.score || '0:0'}</span>
            <span class="${t2Class}">${game.team2}${game.team2Suffix ? `<span class="team-suffix">${game.team2Suffix}</span>` : ''}</span>
          </div>
          <div class="game-number">GAME ${gameNumber}</div>
          <div class="game-date">${game.date} ‚Ä¢ ${game.time}</div>
          <div class="venue"><a href="${game.venueLink}" target="_blank" rel="noopener"> ${game.venue}</a></div>
        `;
        container.appendChild(el);
      });
    }

    function toggleAdminMode(){
      adminMode = !adminMode;
      const btn = document.querySelector('.admin-toggle');
      const addBtn = document.getElementById('addGameBtn');
      const exportBtn = document.getElementById('exportBtn');
      btn.textContent = `Admin Mode: ${adminMode ? 'ON' : 'OFF'}`;
      btn.style.background = adminMode ? '#dc3545' : '#0066cc';
      if(addBtn) addBtn.style.display = adminMode ? 'inline-flex' : 'none';
      if(exportBtn) exportBtn.style.display = adminMode ? 'inline-flex' : 'none';
      renderGames();
    }

    function editGame(index){
      const game = games[index];
      document.getElementById('editIndex').value = index;
      document.getElementById('editGameNumber').value = index + 1;
      document.getElementById('editType').value = game.type;
      document.getElementById('editTeam1').value = game.team1;
      document.getElementById('editTeam1Suffix').value = game.team1Suffix || '';
      document.getElementById('editTeam2').value = game.team2;
      document.getElementById('editTeam2Suffix').value = game.team2Suffix || '';
      document.getElementById('editScore').value = game.score || '0:0';
      document.getElementById('editDate').value = game.date || '';
      document.getElementById('editTime').value = game.time || '';
      document.getElementById('editVenue').value = game.venue || '';
      document.getElementById('editVenueLink').value = game.venueLink || '';
      document.getElementById('editModal').style.display = 'flex';
    }

    function addNewGame(){
      document.getElementById('editIndex').value = -1;
      document.getElementById('editGameNumber').value = games.length + 1;
      document.getElementById('editType').value = 'home';
      document.getElementById('editTeam1').value = 'PHK';
      document.getElementById('editTeam1Suffix').value = '';
      document.getElementById('editTeam2').value = '';
      document.getElementById('editTeam2Suffix').value = '';
      document.getElementById('editScore').value = '0:0';
      document.getElementById('editDate').value = '';
      document.getElementById('editTime').value = '';
      document.getElementById('editVenue').value = '◊ë◊ô◊î"◊° ◊û◊¢◊ô◊ô◊†◊ï◊™, ◊®◊ó\' ◊î◊¶◊ú◊ô◊ú 8, ◊§◊®◊ì◊° ◊ó◊†◊î ◊õ◊®◊õ◊ï◊®';
      document.getElementById('editVenueLink').value = 'https://maps.app.goo.gl/ehjmqR18a53PCmG7A';
      document.getElementById('editModal').style.display = 'flex';
    }

    function deleteGame(index){
      if(confirm('Are you sure you want to delete this game?')){
        games.splice(index,1);
        leagueData[currentLeague].games = games;
        saveGames(); renderGames();
      }
    }

    function closeModal(){ document.getElementById('editModal').style.display = 'none'; }

    // Service worker ‚Äì keep registration (consider bumping cache version in sw.js after deployment)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function(){
        navigator.serviceWorker.register('./sw.js');
      });
    }

    // init
    window.addEventListener('load', loadGamesFromJSON);
  </script>
</body>
</html>
